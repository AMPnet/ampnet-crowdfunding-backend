= AMPnet Crowdfunding API documentation
:toc: left
:sectnums:
:toclevels: 2
:source-highlighter: prettify
:docinfo: shared

== Registration API
Collection of endpoints for registering users

=== Social method - Facebook and Google

==== Successful user signup (FACEBOOK method)
.Request
include::{snippets}/RegistrationControllerTest/signupUsingFacebookMethod/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/signupUsingFacebookMethod/http-response.adoc[]

==== Successful user signup (GOOGLE method)
.Request
include::{snippets}/RegistrationControllerTest/signupUsingGoogleMethod/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/signupUsingGoogleMethod/http-response.adoc[]

=== Email method

==== Successful user signup
.Request
include::{snippets}/RegistrationControllerTest/mustBeAbleToSignUpUser/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/mustBeAbleToSignUpUser/http-response.adoc[]

==== Incomplete signup information
.Request
include::{snippets}/RegistrationControllerTest/incompleteSignupRequestShouldFail/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/incompleteSignupRequestShouldFail/http-response.adoc[]

==== Signup information complete but invalid

===== Invalid country id
.Request
include::{snippets}/RegistrationControllerTest/invalidCountryIdSignupRequestShouldFail/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/invalidCountryIdSignupRequestShouldFail/http-response.adoc[]

===== Empty first name
.Request
include::{snippets}/RegistrationControllerTest/emptyNameSignupRequestShouldFail/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/emptyNameSignupRequestShouldFail/http-response.adoc[]

===== Invalid email
.Request
include::{snippets}/RegistrationControllerTest/invalidEmailSignupRequestShouldFail/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/invalidEmailSignupRequestShouldFail/http-response.adoc[]

===== Short password
.Request
include::{snippets}/RegistrationControllerTest/shortPasswordSignupRequestShouldFail/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/shortPasswordSignupRequestShouldFail/http-response.adoc[]

===== Invalid phone number
.Request
include::{snippets}/RegistrationControllerTest/invalidPhoneNumberSignupRequestShouldFail/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/invalidPhoneNumberSignupRequestShouldFail/http-response.adoc[]

==== Signup failed because user exists
.Request
include::{snippets}/RegistrationControllerTest/signupShouldFailIfUserAlreadyExists/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/signupShouldFailIfUserAlreadyExists/http-response.adoc[]

==== Email confirmation

===== Successful Email confirmation
.Request
include::{snippets}/RegistrationControllerTest/mustBeAbleToConfirmEmail/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/mustBeAbleToConfirmEmail/http-response.adoc[]

===== Resend Email confirmation
.Request
include::{snippets}/RegistrationControllerTest/mustBeAbleToResendConfirmationEmail/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/mustBeAbleToResendConfirmationEmail/http-response.adoc[]

===== Failed Email confirmation, invalid token format
.Request
include::{snippets}/RegistrationControllerTest/mustGetBadRequestForInvalidTokenFormat/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/mustGetBadRequestForInvalidTokenFormat/http-response.adoc[]

===== Failed Email confirmation, non existing token
.Request
include::{snippets}/RegistrationControllerTest/mustGetNotFoundRandomToken/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/mustGetNotFoundRandomToken/http-response.adoc[]

===== Failed Email confirmation, token expired
.Request
include::{snippets}/RegistrationControllerTest/mustNotBeAbleToConfirmEmailWithExpiredToken/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/mustNotBeAbleToConfirmEmailWithExpiredToken/http-response.adoc[]

==== Check Email

===== Email used
.Request
include::{snippets}/RegistrationControllerTest/mustReturnTrueIfEmailIsUsed/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/mustReturnTrueIfEmailIsUsed/http-response.adoc[]

===== Email not used
.Request
include::{snippets}/RegistrationControllerTest/mustReturnFalseForUnusedEmail/http-request.adoc[]
.Response
include::{snippets}/RegistrationControllerTest/mustReturnFalseForUnusedEmail/http-response.adoc[]

== Authentication API

=== Successful user signin (EMAIL method)
.Request
include::{snippets}/AuthenticationControllerTest/signInRegular/http-request.adoc[]
.Response
include::{snippets}/AuthenticationControllerTest/signInRegular/http-response.adoc[]

=== Successful user signin (GOOGLE method)

Token in this case is obtained from Google on frontend, and then passed as request parameter.

.Request
include::{snippets}/AuthenticationControllerTest/signInGoogle/http-request.adoc[]
.Response
include::{snippets}/AuthenticationControllerTest/signInGoogle/http-response.adoc[]

=== Successful user signin (FACEBOOK method)

Token in this case is obtained from Facebook on frontend, and then passed as request parameter.

.Request
include::{snippets}/AuthenticationControllerTest/signInFacebook/http-request.adoc[]
.Response
include::{snippets}/AuthenticationControllerTest/signInFacebook/http-response.adoc[]

=== Invalid credentials
.Request
include::{snippets}/AuthenticationControllerTest/signInWithInvalidCredentialsShouldFail/http-request.adoc[]
.Response
include::{snippets}/AuthenticationControllerTest/signInWithInvalidCredentialsShouldFail/http-response.adoc[]

=== Invalid login method

For example, user was registered using regular method (filling out email, password...) but he is trying
to login using Google oauth.

.Request
include::{snippets}/AuthenticationControllerTest/signInWithInvalidLoginMethodShouldFail/http-request.adoc[]
.Response
include::{snippets}/AuthenticationControllerTest/signInWithInvalidLoginMethodShouldFail/http-response.adoc[]

=== Non-existing user login
.Request
include::{snippets}/AuthenticationControllerTest/signInWithNonExistingUserShouldFail/http-request.adoc[]
.Response
include::{snippets}/AuthenticationControllerTest/signInWithNonExistingUserShouldFail/http-response.adoc[]

== Users API
Collection of endpoints for managing users

=== Successful fetch list of users (admin)
.Request
include::{snippets}/UserControllerTest/mustBeAbleToGetAListOfUsers/http-request.adoc[]
.Response
include::{snippets}/UserControllerTest/mustBeAbleToGetAListOfUsers/http-response.adoc[]

=== Failed fetch list of users (not admin)
.Request
include::{snippets}/UserControllerTest/mustNotBeAbleToGetAListOfUsersWithoutAdminPermission/http-request.adoc[]
.Response
include::{snippets}/UserControllerTest/mustNotBeAbleToGetAListOfUsersWithoutAdminPermission/http-response.adoc[]

=== Failed to fetch list of users because incomplete user profile
.Request
include::{snippets}/UserControllerTest/mustThrowErrorForIncompleteUserProfile/http-request.adoc[]
.Response
include::{snippets}/UserControllerTest/mustThrowErrorForIncompleteUserProfile/http-response.adoc[]

=== Successful fetch own profile
.Request
include::{snippets}/UserControllerTest/mustBeAbleToGetOwnProfile/http-request.adoc[]
.Response
include::{snippets}/UserControllerTest/mustBeAbleToGetOwnProfile/http-response.adoc[]

=== Successful update own profile
.Request
include::{snippets}/UserControllerTest/mustBeAbleToUpdateProfile/http-request.adoc[]
.Response
include::{snippets}/UserControllerTest/mustBeAbleToUpdateProfile/http-response.adoc[]

=== Failed to update others profile
.Request
include::{snippets}/UserControllerTest/mustNotBeAbleToUpdateOthersUserProfile/http-request.adoc[]
.Response
include::{snippets}/UserControllerTest/mustNotBeAbleToUpdateOthersUserProfile/http-response.adoc[]

=== Organization invites

==== Get a list of organization invites
.Request
include::{snippets}/UserControllerTest/mustBeAbleToGetOrganizationInvites/http-request.adoc[]
.Response
include::{snippets}/UserControllerTest/mustBeAbleToGetOrganizationInvites/http-response.adoc[]

==== Accept organization invite
`/me/invites/{organizationId}/accept`

.Request
include::{snippets}/UserControllerTest/mustBeAbleToAcceptOrganizationInvite/http-request.adoc[]
.Response
include::{snippets}/UserControllerTest/mustBeAbleToAcceptOrganizationInvite/http-response.adoc[]

==== Reject organization invite
`/me/invites/{organizationId}/reject`

.Request
include::{snippets}/UserControllerTest/mustBeAbleToRejectOrganizationInvite/http-request.adoc[]
.Response
include::{snippets}/UserControllerTest/mustBeAbleToRejectOrganizationInvite/http-response.adoc[]

== Countries API
Collection of endpoints for fetching countries

=== Get all countries
.Request
include::{snippets}/CountryControllerTest/mustBeAbleToGetAListOfAllCountries/http-request.adoc[]
.Response
include::{snippets}/CountryControllerTest/mustBeAbleToGetAListOfAllCountries/http-response.adoc[]

=== Get country by id
.Request
include::{snippets}/CountryControllerTest/mustBeAbleToGetACountryById/http-request.adoc[]
.Response
include::{snippets}/CountryControllerTest/mustBeAbleToGetACountryById/http-response.adoc[]

=== Invalid country id
.Request
include::{snippets}/CountryControllerTest/mustReturnNotFoundForInvalidCountryId/http-request.adoc[]
.Response
include::{snippets}/CountryControllerTest/mustReturnNotFoundForInvalidCountryId/http-response.adoc[]

== Wallet API
Collection of endpoints for managing wallets

=== User Wallet
Collection of endpoints for managing User wallet

==== Get wallet for active user
.Request
include::{snippets}/WalletControllerTest/mustBeAbleToGetOwnWallet/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustBeAbleToGetOwnWallet/http-response.adoc[]

==== Active user does not have a wallet
.Request
include::{snippets}/WalletControllerTest/mustReturnNotFoundForMissingWallet/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustReturnNotFoundForMissingWallet/http-response.adoc[]

==== Create Wallet

===== Create wallet for active user
.Request
include::{snippets}/WalletControllerTest/mustBeAbleToCreateWallet/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustBeAbleToCreateWallet/http-response.adoc[]

===== Invalid wallet address
.Request
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateWalletWithInvalidAddress/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateWalletWithInvalidAddress/http-response.adoc[]

===== Active user cannot create wallet with invalid wallet address
.Request
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateWalletWithInvalidAddress/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateWalletWithInvalidAddress/http-response.adoc[]

===== Active user cannot create additional wallet
.Request
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateAdditionalWallet/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateAdditionalWallet/http-response.adoc[]

=== Project Wallet
Collection of endpoints for managing Project wallet

==== Get project wallet

===== Successfully get wallet
.Request
include::{snippets}/WalletControllerTest/mustBeAbleToGetProjectWallet/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustBeAbleToGetProjectWallet/http-response.adoc[]

===== Project does not have a wallet
.Request
include::{snippets}/WalletControllerTest/mustGetNotFoundIfWalletIsMissing/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustGetNotFoundIfWalletIsMissing/http-response.adoc[]

===== Project does not exists
.Request
include::{snippets}/WalletControllerTest/mustNotBeAbleToGetWalletIfUserDidNotCreatedProject/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustNotBeAbleToGetWalletIfUserDidNotCreatedProject/http-response.adoc[]

===== User did not create the project
User can only access a wallet for project HE created

.Request
include::{snippets}/WalletControllerTest/mustNotBeAbleToGetWalletIfUserDidNotCreatedProject/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustNotBeAbleToGetWalletIfUserDidNotCreatedProject/http-response.adoc[]

==== Create project wallet

===== Successfully create
.Request
include::{snippets}/WalletControllerTest/mustBeAbleToCreateProjectWallet/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustBeAbleToCreateProjectWallet/http-response.adoc[]

===== Project wallet exists
.Request
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateAdditionalProjectWallet/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateAdditionalProjectWallet/http-response.adoc[]

===== Cannot create project wallet
User can create wallet only for project that HE created

.Request
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateWalletIfUserDidNotCreatedProject/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateWalletIfUserDidNotCreatedProject/http-response.adoc[]

===== Missing project
.Request
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateWalletForNonExistingProject/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateWalletForNonExistingProject/http-response.adoc[]

===== Invalid address
.Request
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateProjectWalletWithInvalidAddress/http-request.adoc[]
.Response
include::{snippets}/WalletControllerTest/mustNotBeAbleToCreateProjectWalletWithInvalidAddress/http-response.adoc[]

== Organization API
Collection of endpoints for managing organization

=== Create organization
.Request
include::{snippets}/OrganizationControllerTest/mustBeAbleToCreateOrganization/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustBeAbleToCreateOrganization/http-response.adoc[]

=== Get organization by id
.Request
include::{snippets}/OrganizationControllerTest/mustBeAbleToGetOrganization/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustBeAbleToGetOrganization/http-response.adoc[]

=== Get all organizations
.Request
include::{snippets}/OrganizationControllerTest/mustReturnListOfOrganizations/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustReturnListOfOrganizations/http-response.adoc[]

=== Get personal organizations
.Request
include::{snippets}/OrganizationControllerTest/mustBeAbleToGetPersonalOrganizations/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustBeAbleToGetPersonalOrganizations/http-response.adoc[]

=== Approve organization
To approve organization user must have privilege: PWA_ORG

==== Approve organization with Admin role
.Request
include::{snippets}/OrganizationControllerTest/mustBeAbleToApproveOrganization/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustBeAbleToApproveOrganization/http-response.adoc[]

==== Cannot approve organization without privilege
.Request
include::{snippets}/OrganizationControllerTest/mustNotBeAbleApproveOrganizationWithoutPrivilege/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustNotBeAbleApproveOrganizationWithoutPrivilege/http-response.adoc[]

=== Get organization members
.Request
include::{snippets}/OrganizationControllerTest/mustReturnUsersListForOrganization/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustReturnUsersListForOrganization/http-response.adoc[]

=== Invite user to organization

==== Successfully invite user to organization with organization admin role, privilege PW_USERS
.Request
include::{snippets}/OrganizationControllerTest/mustBeAbleToInviteUserToOrganizationWithOrgAdminRole/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustBeAbleToInviteUserToOrganizationWithOrgAdminRole/http-response.adoc[]

==== Failed invite user to organization without organization user role, privilege PW_USERS
.Request
include::{snippets}/OrganizationControllerTest/mustNotBeAbleToInviteUserToOrganizationWithoutOrgAdminRole/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustNotBeAbleToInviteUserToOrganizationWithoutOrgAdminRole/http-response.adoc[]

==== Revoke user invitation
`/organization/{organizationId}/invite/{revokeUserId}/revoke`

.Request
include::{snippets}/OrganizationControllerTest/mustBeAbleToRevokeUserInvitation/http-request.adoc[]
.Response
include::{snippets}/OrganizationControllerTest/mustBeAbleToRevokeUserInvitation/http-response.adoc[]

== Project API
Collection of endpoints for managing project

=== Get project

==== Project exists
.Request
include::{snippets}/ProjectControllerTest/mustReturnProject/http-request.adoc[]
.Response
include::{snippets}/ProjectControllerTest/mustReturnProject/http-response.adoc[]

==== Project missing
.Request
include::{snippets}/ProjectControllerTest/mustReturnNotFoundForMissingProject/http-request.adoc[]
.Response
include::{snippets}/ProjectControllerTest/mustReturnNotFoundForMissingProject/http-response.adoc[]

=== Create project
.Request
include::{snippets}/ProjectControllerTest/mustReturnNotFoundForMissingProject/http-request.adoc[]
.Response
include::{snippets}/ProjectControllerTest/mustReturnNotFoundForMissingProject/http-response.adoc[]

==== Successfully create
.Request
include::{snippets}/ProjectControllerTest/mustBeAbleToCreateProject/http-request.adoc[]
.Response
include::{snippets}/ProjectControllerTest/mustBeAbleToCreateProject/http-response.adoc[]

==== Cannot create project without privilege
User cannot create project without admin role in organization, privilege: PW_PROJECT

.Request
include::{snippets}/ProjectControllerTest/mustReturnErrorForUserWithoutOrganizationMembership/http-request.adoc[]
.Response
include::{snippets}/ProjectControllerTest/mustReturnErrorForUserWithoutOrganizationMembership/http-response.adoc[]
